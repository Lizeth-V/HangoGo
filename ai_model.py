import pandas as pd
import numpy as np

# extract data from database json & drop irrelevant columns to start training
with open('Hango.Places.json', encoding='utf-8') as f:
    df = pd.read_json(f)
df = df.drop(columns=["weblink", "name", "address"])
# encode our categories (our labels) as numerical representation instead of strings
df['main_type'] = pd.factorize(df['main_type'])[0]

# encode our sub categories as numerical representation instead of strings (all_sub list comes from create_sublist.py)
all_sub = ['architectural_tours', 'breweries', 'bikes', 'coffeeshops', 'library', 'recreation_centers', 'florist', 'steakhouses', 'snorkeling', 'street_vendors', 'tuscan', 'aquariums', 'sports_clubs', 'nurseries_&_gardening', 'distilleries', 'historical_tours', 'food_tours', 'halal', 'restaurant', 'surfing', 'hobby_shops', 'noodles', 'desserts', 'australian', 'thai', 'cafe', 'diners', 'music_&_video', 'butcher', 'drive-in_theater', 'movie_theater', 'chicken_wings', 'professional_sports_teams', 'massage', 'country_clubs', 'beer', 'carousels', 'food', 'wholesale_stores', 'hotels_&_travel', 'internet_cafes', 'hong_kong_style_cafe', 'italian', 'mongolian', 'transportation', 'asian_fusion', 'books', 'drugstores', 'coffee_roasteries', 'ramen', 'american_(new)', 'local_flavor', 'tacos', 'indian', 'wraps', 'hot_dogs', 'beer_tours', 'hot_pot', 'delis', 'new_mexican_cuisine', 'parks', 'pet_services', 'arts_&_crafts', 'zoo', 'stadiums_&_arenas', 'botanical_gardens', 'tiki_bars', 'pool_halls', 'meal_takeaway', 'food_trucks', 'himalayan/nepalese', 'imported_food', 'sports_bars', 'ethiopian', 'cosmetics_&_beauty_supply', 'whiskey_bars', 'playgrounds', 'travel_services', 'dance_studios', 'peruvian', 'pizza', 'patisserie/cake_shop', 'florists', 'kids_activities', 'herbs_&_spices', 'gun/rifle_ranges', 'cheese_shops', 'cupcakes', 'karate', 'beauty_&_spas', 'macarons', 'soup', 'scooter_rentals', 'outdoor_gear', 'pretzels', 'csa', 'piano_bars', 'rafting/kayaking', 'farmers_market', 'motorcycle_rental', 'arabic', 'trainers', 'tours', 'clothing_store', 'vietnamese', 'garage_door_services', 'nature', 'self-defense_classes', 'aerial_fitness', 'ticket_sales', 'salad', 'bowling_alley', 'burgers', 'pubs', 'vegetarian', 'pilates', 'creperies', 'cantonese', 'walking_tours', 'sailing', 'skate_shops', 'souvenir_shops', 'campgrounds', 'karaoke', 'moroccan', 'acai_bowls', 'sporting_goods', 'tapas_bars', 'amateur_sports_teams', 'indonesian', 'belgian', 'brewpubs', 'meat_shops', 'chocolatiers_&_shops', 'wholesalers', 'meal_delivery', 'vitamins_&_supplements', 'cafes', 'spanish', 'discount_store', 'pop-up_restaurants', 'jazz_&_blues', 'batting_cages', 'summer_camps', 'pakistani', 'ethnic_grocery', 'shaved_ice', 'cheesesteaks', 'fast_food', 'lakes', 'german', 'ice_cream_&_frozen_yogurt', 'argentine', 'soul_food', 'champagne_bars', 'arts_&_entertainment', 'beverage_store', 'park', 'hookah_bars', 'hot_tub_&_pool', 'golf', 'beer_bar', 'atv_rentals/tours', 'specialty_food', 'brazilian_jiu-jitsu', 'skating_rinks', 'barre_classes', 'french', 'scandinavian', 'home_services', 'entertainment', 'social_clubs', 'ethnic_food', 'beer_gardens', 'wine_bars', 'amusement_parks', 'appliances', 'buffets', 'british', 'antiques', 'home_&_garden', 'cycling_classes', 'day_spas', 'chinese', 'music_venues', 'pasta_shops', 'music_&_dvds', 'kitchen_&_bath', 'barbers', 'grocery', 'keys_&_locksmiths', 'video_game_stores', 'tennis', 'sushi_bars', 'contractors', 'wine_tours', 'escape_games', 'pet_store', 'custom_cakes', 'hunting_&_fishing_supplies', 'donuts', 'car_rental', 'gluten-free', 'speakeasies', 'fondue', "children's_museums", 'tapas/small_plates', 'bagels', 'greek', 'organic_stores', 'tourist_attraction', 'beauty_salon', 'hang_gliding', 'hawaiian', 'szechuan', 'guns_&_ammo', 'swimming_pools', 'videos_&_video_game_rental', 'comedy_clubs', 'horseback_riding', 'spiritual_shop', 'electronics', 'mountain_biking', 'boxing', 'used_bookstore', 'japanese', 'hiking', 'bubble_tea', 'do-it-yourself_food', 'night_club', 'rv_parks', 'races_&_competitions', 'whale_watching_tours', 'coffee_&_tea', 'tanning', 'boot_camps', 'irish_pub', 'american_(traditional)', 'farms', 'soccer', 'yoga', 'comfort_food', 'caribbean', 'juice_bars_&_smoothies', 'festivals', 'dive_bars', 'performing_arts', 'cuban', 'rv_rental', 'museum', 'active_life', 'olive_oil', 'gastropubs', 'wine_tasting_room', 'food_delivery_services', 'kickboxing', 'southern', 'korean', 'breakfast_&_brunch', 'kebab', 'bakery', 'barbeque', 'boating', 'cajun/creole', 'fruits_&_veggies', 'home_decor', 'paragliding', 'tex-mex', 'shopping', 'livestock_feed_&_supply', 'pan_asian', 'fitness/exercise_equipment', 'tobacco_shops', 'fishing', 'seafood', 'airlines', 'middle_eastern', 'professional_services', 'golf_lessons', 'dog_parks', 'spa', 'turkish', 
'nightlife', 'vegan', 'bike_tours', 'beaches', 'art_gallery', 'fitness_&_instruction', 'golf_equipment', 'shopping_centers', 'tea_rooms', 'store', 'wineries', 'beach_equipment_rentals', 'toy_stores', 'pop-up_shops', 'wine_&_spirits', 'cideries', 'candy_stores', 'kombucha', 'lebanese', 'empanadas', 'delicatessen', 'latin_american', 'amusement_park', 'live/raw_food', 'pet_sitting', 'pool_&_hot_tub_service', 'mags', 'brazilian', 'virtual_reality_centers', 'pets', 'tabletop_games', 'art_supplies', 'food_court', 'gay_bars', 'outlet_stores', 'building_supplies', 'bike_rentals', 'international_grocery', 'dim_sum', 'basque', 'bookstore', 'taiwanese', 'gelato', 'cocktail_bars', 'public_markets', 'lounges', 'paddleboarding', 'fish_&_chips', 'martial_arts', 'bus_tours', 'poke', 'cinema', 'cardio_classes', 'mediterranean', 'flowers_&_gifts', 'mexican', 'food_stands', 'golf_equipment_shops', 'pool_cleaners', 'gift_shops', 'modern_european', 'club_crawl', 'dance_clubs', 'falafel', 'cafeteria', 'health_markets', 'skydiving', 'archery', 'seafood_markets', 'chicken_shop', 'sandwiches', 'bar', 'irish', 'skate_parks']
labels, unique_labels = pd.factorize(all_sub)

new_sub = []
for sub_types_list in df['sub_types']:
    for i in range(len(sub_types_list)):
        sub_types_list[i] = np.where(unique_labels == sub_types_list[i])[0][0]
print(df[['main_type', 'sub_types']])